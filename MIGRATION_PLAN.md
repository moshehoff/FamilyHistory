# Migration Plan: Move Source Content Out of Site Directory

## Current Problem

Files that should be **source files** (not generated) are currently inside `site/` directory:

### Manual Source Files in site/ (Should Move Out):
1. **`site/content/index.md`** - Home page
2. **`site/content/pages/about.md`** - About page

### Generated Files (Already Excluded by .gitignore):
- `site/content/profiles/` - Generated by doit.py
- `site/quartz/static/family-data.json` - Generated by doit.py
- `site/quartz/static/media-index.json` - Generated by doit.py
- `site/quartz/static/documents/` - Copied from documents/ by doit.py
- `site/content/*.png` - Copied from bios/ by doit.py

### Quartz Framework Files (Should Stay in site/):
- `site/quartz/components/` - Quartz components (NavBar, ProfileTabs, etc.)
- `site/quartz.layout.ts` - Layout configuration
- `site/quartz.config.ts` - Quartz configuration
- All other Quartz infrastructure files

## Proposed Solution

### 1. Create Source Content Directory Structure

```
content/
├── index.md           # Home page (moved from site/content/)
└── pages/
    └── about.md       # About page (moved from site/content/pages/)

site/
└── content/           # Should only contain GENERATED files
    └── profiles/      # Generated by doit.py (already in .gitignore)
```

### 2. Update doit.py

Add a new function to copy source content into site/:

```python
def copy_source_content(src_content_dir, dst_content_dir):
    """
    Copy source content (index.md, pages/about.md) to site/content/
    This keeps source files separate from generated files.
    """
    import shutil
    
    # Copy index.md
    if os.path.exists(os.path.join(src_content_dir, "index.md")):
        shutil.copy2(
            os.path.join(src_content_dir, "index.md"),
            os.path.join(dst_content_dir, "index.md")
        )
    
    # Copy pages/ directory
    src_pages = os.path.join(src_content_dir, "pages")
    dst_pages = os.path.join(dst_content_dir, "pages")
    
    if os.path.exists(src_pages):
        if os.path.exists(dst_pages):
            shutil.rmtree(dst_pages)
        shutil.copytree(src_pages, dst_pages)
    
    print(f"[DEBUG] Copied source content from {src_content_dir} to {dst_content_dir}")
```

### 3. Update doit.py main() function

```python
def main():
    # ... existing code ...
    
    # Build generated content
    build_obsidian_notes(individuals, families, args.output, args.bios_dir)
    
    # Copy source content
    copy_source_content("content", args.output)  # Copy from project root content/ to site/content/
    
    # ... rest of existing code ...
```

### 4. Update .gitignore

```gitignore
# Generated files from doit.py (not the source)
site/content/profiles/
!site/content/profiles/.gitkeep
site/quartz/static/family-data.json

# Source content (tracked, but copied)
site/content/index.md
site/content/pages/

# Unless explicitly tracked in git
!site/content/index.md
!site/content/pages/about.md

# NO - just let them be copied, don't track them
```

Actually, better approach: Don't track site/content/* at all for source files.

### 5. Clean Repository

Move files to new location and update references:

```bash
# Create content source directory
mkdir content
mkdir content/pages

# Move source files
git mv site/content/index.md content/
git mv site/content/pages/about.md content/pages/

# Keep site/content only for generated files
```

## Benefits

1. ✅ Clear separation: **source files** (in project root) vs **generated files** (in site/)
2. ✅ Source files can be edited without Quartz build artifacts
3. ✅ All content source files in one place (`content/`)
4. ✅ `site/` directory only contains Quartz framework + generated content
5. ✅ Easier to understand what's tracked in git vs what's generated

## Migration Steps

1. **Create content/ directory structure**
2. **Move index.md to content/**
3. **Move pages/about.md to content/pages/**
4. **Update doit.py to copy content/ to site/content/**
5. **Test doit.py still works**
6. **Commit changes**

## File Structure After Migration

```
V4/
├── content/              # SOURCE content (tracked in git)
│   ├── index.md
│   └── pages/
│       └── about.md
├── site/
│   ├── content/          # GENERATED content (.gitignore)
│   │   └── profiles/    # Generated by doit.py
│   ├── quartz/
│   │   ├── components/   # Quartz framework
│   │   ├── static/       # Generated files
│   │   └── ...
│   ├── quartz.layout.ts
│   └── quartz.config.ts
├── bios/                 # SOURCE biographies
├── documents/            # SOURCE documents
├── data/
│   └── tree.ged          # SOURCE GEDCOM
└── scripts/
    └── doit.py           # Generates content from sources

